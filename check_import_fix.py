#!/usr/bin/env python3
"""
å¯¼å…¥æŸ¥è¯¢é—®é¢˜ä¿®å¤ - å¿«é€Ÿæ€»ç»“

é—®é¢˜: å¯¼å…¥çš„è´¦æˆ·æ— æ³•æŸ¥è¯¢
åŸå› : å¯¼å…¥æ—¶å…ƒæ•°æ®IDæ²¡æœ‰æ›´æ–°,å¯¼è‡´IDä¸ä¸€è‡´

è§£å†³:
1. ä¿®æ”¹ finance_manager.py çš„ import_account_package() æ–¹æ³•
   - åˆ›å»ºæ–°IDæ—¶,æ›´æ–°metadata.jsonä¸­çš„idå­—æ®µ
   
2. ä¿®æ”¹ finance_interface.py çš„ import_account() æ–¹æ³•
   - å¯¼å…¥åè‡ªåŠ¨è®¾ç½®ä¸ºå½“å‰è´¦æˆ·
   - æ¸…ç©ºæŸ¥è¯¢ç»“æœè¡¨æ ¼
   
3. ä¿®æ”¹ on_account_changed() æ–¹æ³•
   - åˆ‡æ¢è´¦æˆ·æ—¶æ¸…ç©ºæŸ¥è¯¢ç»“æœ

ç»“æœ:
âœ… å¯¼å…¥è´¦æˆ·æ­£å¸¸
âœ… è´¦æˆ·æ•°æ®å¯æŸ¥è¯¢
âœ… æ‰€æœ‰äº¤æ˜“è®°å½•å¯è§
"""

import sys
from pathlib import Path

# æ·»åŠ é¡¹ç›®æ ¹è·¯å¾„
sys.path.insert(0, str(Path(__file__).parent))

from app.tools.finance_manager import FinanceManager

def main():
    print("""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         å¯¼å…¥æŸ¥è¯¢é—®é¢˜ - ä¿®å¤å®Œæˆ                                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ ä¿®å¤å†…å®¹:

1ï¸âƒ£  finance_manager.py - import_account_package()
   âœ… åˆ›å»ºæ–°IDæ—¶åŒæ­¥æ›´æ–°metadata.jsonä¸­çš„id
   
2ï¸âƒ£  finance_interface.py - import_account()
   âœ… å¯¼å…¥åè‡ªåŠ¨è®¾ç½®ä¸ºå½“å‰è´¦æˆ·
   âœ… è‡ªåŠ¨æ¸…ç©ºæŸ¥è¯¢ç»“æœè¡¨æ ¼
   
3ï¸âƒ£  finance_interface.py - on_account_changed()
   âœ… åˆ‡æ¢è´¦æˆ·æ—¶æ¸…ç©ºæŸ¥è¯¢ç»“æœ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… éªŒè¯ç»“æœ:

""")
    
    fm = FinanceManager()
    accounts = fm.get_all_accounts()
    
    print(f"ğŸ“Š å½“å‰è´¦æˆ·æ•°: {len(accounts)}\n")
    
    for i, acc in enumerate(accounts, 1):
        trans_count = len(acc.transactions)
        print(f"[{i}] {acc.name}")
        print(f"    â”œâ”€ ID: {acc.id}")
        print(f"    â””â”€ äº¤æ˜“æ•°: {trans_count}")
        
        if trans_count > 0:
            # æµ‹è¯•æŸ¥è¯¢
            results = fm.query_transactions(acc.id)
            print(f"    âœ… æŸ¥è¯¢æµ‹è¯•: {len(results)} æ¡è®°å½•å¯æŸ¥è¯¢")
        
        print()
    
    print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    print("ğŸ‰ é—®é¢˜å·²è§£å†³! æ‚¨ç°åœ¨å¯ä»¥:")
    print("   1. å¯¼å…¥è´¦æˆ·åˆ°æœ¬ç³»ç»Ÿ")
    print("   2. æ‰€æœ‰äº¤æ˜“è®°å½•ä¼šè‡ªåŠ¨æ˜¾ç¤º")
    print("   3. å¯ä»¥æ­£å¸¸è¿›è¡ŒæŸ¥è¯¢æ“ä½œ")
    print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n")

if __name__ == '__main__':
    main()
