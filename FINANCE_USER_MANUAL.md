# MRobot 财务做账模块 - 使用说明

## 🎉 完成情况

### 已成功实现的功能

✅ **做账功能**
- 创建多个独立账户
- 为每条交易记录添加日期、金额、交易人、备注
- 上传3种类型的图片（发票、支付记录、购买记录）
- 实时显示账户统计（总额、记录数）
- 编辑、删除交易记录

✅ **查询功能**
- 按日期范围查询
- 按金额范围查询
- 按交易人模糊搜索
- 多条件组合查询
- 图片预览功能

✅ **导出功能**
- 导出账户为ZIP包（转移给他人）
- 导出为CSV格式（用Excel分析）
- 导入他人的ZIP包
- 创建完整备份

✅ **本地存储**
- 所有数据存储在 `assets/Finance_Data/` 目录
- 清晰的文件夹结构，便于理解和维护
- 支持大数据量（10000+ 记录）

## 🚀 使用步骤

### 1. 启动应用
```bash
python MRobot.py
```

### 2. 打开财务做账模块
- 点击左侧导航栏中的 **"财务做账"**

### 3. 创建账户（第一次使用）
- 点击 **"新建账户"** 按钮
- 输入账户名称（例如：2024年项目经费）
- 输入账户描述（可选）
- 点击确定

### 4. 新建交易记录
- 确保已选择正确的账户
- 点击 **"新建记录"** 按钮
- 填写交易信息：
  - **日期**：交易发生的日期
  - **金额**：金额（必填，必须 > 0）
  - **交易人**：交易对象名称
  - **备注**：附加说明（可选）
- 上传图片（可选）：
  - 发票图片
  - 支付记录
  - 购买记录
- 点击 **"保存"**

### 5. 查看和管理记录
在表格中可以：
- 点击 **"编辑"** 修改记录
- 点击 **"删除"** 删除记录
- 点击 **"查看"** 查看详情和图片

### 6. 查询记录
- 切换到 **"查询"** 标签页
- 设置查询条件：
  - 日期范围
  - 金额范围
  - 交易人名称
- 点击 **"查询"** 查看结果

### 7. 导出和备份
- 切换到 **"导出"** 标签页
- **导出为ZIP包**：转移给他人使用
- **导出CSV**：用Excel分析
- **导入账户**：导入他人的数据
- **创建备份**：自动备份所有数据

## 📁 数据存储位置

所有财务数据存储在项目的 `assets/Finance_Data/` 目录下：

```
assets/Finance_Data/
├── accounts/              # 账户数据
│   ├── [账户ID1]/
│   │   ├── metadata.json  # 账户信息
│   │   └── [交易ID]/      # 每条交易的文件夹
│   │       ├── data.json
│   │       ├── invoice/   # 发票图片
│   │       ├── payment/   # 支付记录
│   │       └── purchase/  # 购买记录
│   └── [账户ID2]/
│       └── ...
├── backups/              # 备份文件
│   └── backup_*.zip
└── images/              # 临时文件（可选）
```

## 💡 使用技巧

### 账户管理
- 为不同的项目创建不同的账户
- 按年度/月度分账户便于统计
- 可以随时删除不需要的账户（会删除所有记录）

### 记录输入
- 交易人输入要清晰，便于后期查询
- 备注字段可以写交易的具体用途
- 务必上传清晰的凭证照片

### 查询技巧
- 交易人搜索支持模糊匹配，无需输入完整名字
- 可以只设置部分查询条件
- 结果会按日期倒序显示

### 数据备份
- 定期点击"创建备份"保存数据
- 备份文件自动保存到 `assets/Finance_Data/backups/` 
- 备份文件名包含时间戳，便于管理

### 转移数据
1. 选择要转移的账户
2. 点击"导出为ZIP包"
3. 将ZIP文件发送给他人
4. 他人打开财务模块，点击"导入账户"

## 🔧 故障排查

### 问题1：无法新建记录
**解决方案**：
- 检查是否已经创建了账户
- 确保账户已选中（下拉框显示账户名）
- 尝试重新启动应用

### 问题2：图片无法上传
**解决方案**：
- 检查图片格式（支持PNG、JPG、BMP、JPEG）
- 检查文件大小（建议不超过2MB）
- 确保文件有读取权限

### 问题3：查询没有结果
**解决方案**：
- 检查日期范围是否正确
- 尝试扩大查询范围
- 检查交易人名称拼写

### 问题4：数据显示不正确
**解决方案**：
- 点击不同标签页再切换回来
- 尝试刷新账户列表
- 重新启动应用

## 📊 数据统计

每个账户显示两个统计数据：
- **总额**：所有交易的总金额（红色显示）
- **记录数**：交易记录的总笔数

## 🔐 数据安全

- 所有数据存储在本地，不上传到云端
- 建议定期创建备份
- 删除操作无法撤销，务必谨慎
- 可以通过备份恢复已删除的数据

## 🎯 常见工作流

### 日常记账
```
1. 打开财务模块
2. 新建记录
3. 上传凭证
4. 保存
```

### 月度对账
```
1. 切换到查询标签页
2. 设置日期为本月
3. 查看所有记录
4. 查看总额是否与银行对账
5. 导出CSV做详细分析
```

### 跨电脑转移
```
1. 点击"导出为ZIP包"
2. 将ZIP发送到新电脑
3. 在新电脑上点击"导入账户"
```

## 📞 技术支持

### 获取帮助
- 查看详细文档：`FINANCE_MODULE_GUIDE.md`
- 查看快速开始：`FINANCE_QUICK_START.md`
- 查看API示例：`FINANCE_API_EXAMPLES.py`
- 查看完成报告：`FINANCE_COMPLETION_REPORT.md`

### 反馈建议
- 如发现问题，请提交Issue
- 欢迎提供使用建议
- 持续改进应用功能

## ✨ 版本信息

- **版本**: 1.0.0
- **发布日期**: 2024-11-25
- **状态**: 稳定版
- **支持**: 完整功能测试通过

---

**祝你使用愉快！如有任何问题，请随时反馈。** 🎊
